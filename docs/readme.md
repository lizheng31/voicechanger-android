# VoiceChager - Android 变声器应用

一款简洁现代的 Android 变声器应用，支持录音、变声和音频管理功能。

## 功能特点

### 1. 录音功能
- 支持高质量音频录制 (16kHz采样率, 单声道, 128kbps比特率)
- 实时显示录音状态和时长
- 自动保存为 MP3 格式

### 2. 变声处理
- 支持多种预设音色：
  - 虫虫-温柔女声
  - 超哥-磁性男声
  - 小丸子-可爱女声
  - 更多音色持续添加中...
- 实时音频转换
- 支持 MP3 格式输入输出

### 3. 音频管理
- 分类显示原声和变声后的音频
- 支持音频预览播放
- 显示音频详细信息（时长、大小、录制时间）
- 支持音频文件删除

## 技术实现

### 1. 音频处理
- 使用 MediaRecorder 进行音频录制
- 采用 FFmpeg 处理音频格式转换
- WebSocket 实现实时音频传输

### 2. 用户界面
- 采用 Material Design 3 设计规范
- 自适应图标设计（渐变色声波图案）
- 流畅的动画过渡效果

### 3. 文件管理
- 适配 Android 存储框架
- 分目录管理原声和变声文件
- 自动生成规范的文件命名

## 项目结构

```mermaid
sequ
</rewritten_file>

## 微信集成开发计划

### 1. 功能设计
- 悬浮球控制面板
  - 支持快速切换音色
  - 显示当前选中的变声音频
  - 提供快速录音入口
  - 可自由拖动和调整透明度

- 智能识别机制
  - 识别微信语音输入状态
  - 自动检测"按住说话"按钮
  - 支持多种聊天场景(私聊/群聊)

### 2. 技术实现方案

#### 2.1 无障碍服务实现
```java
// VoiceAccessibilityService.java
public class VoiceAccessibilityService extends AccessibilityService {
    @Override
    public void onAccessibilityEvent(AccessibilityEvent event) {
        // 识别微信语音按钮
        // 模拟按压事件
        // 播放变声音频
    }
}
```

#### 2.2 操作流程
1. 用户按下微信语音按钮
2. 服务检测到按压事件
3. 自动播放选中的变声音频
4. 松开按钮时自动发送

### 3. 用户体验优化

#### 3.1 便捷操作
- 支持预设多个常用音色
- 手势快捷切换音频
- 支持连续发送不同音色

#### 3.2 智能调节
- 自动调整播放音量
- 智能控制播放时长
- 防止声音录入重叠

#### 3.3 容错处理
- 播放失败自动重试
- 网络异常智能提示
- 权限检查和引导

### 4. 实现步骤

1. 基础框架搭建
   - 实现无障碍服务
   - 添加悬浮窗权限
   - 设计控制面板UI

2. 核心功能开发
   - 微信按钮识别
   - 音频播放控制
   - 事件同步处理

3. 交互优化
   - 添加操作动画
   - 优化响应速度
   - 完善提示信息

4. 测试和优化
   - 兼容性测试
   - 性能优化
   - 用户体验改进

### 5. 注意事项

1. 性能考虑
   - 最小化后台资源占用
   - 优化音频加载速度
   - 控制内存使用

2. 兼容性
   - 适配不同 Android 版本
   - 兼容各版本微信
   - 处理不同机型差异

3. 用户隐私
   - 明确权限使用说明
   - 保护用户聊天隐私
   - 安全存储音频文件

### 6. 预期效果

- 操作流畅自然
- 切换便捷快速
- 播放稳定可靠
- 资源占用小
- 兼容性好

### 7. 进度规划

| 阶段 | 时间 | 主要工作 |
|------|------|----------|
| 准备 | 1周 | 技术调研、方案设计 |
| 开发 | 2周 | 核心功能实现 |
| 优化 | 1周 | 性能和体验优化 |
| 测试 | 1周 | 兼容性和稳定性测试 |
